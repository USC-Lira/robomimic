
============= Initialized Observation Utils with Obs Spec =============

using obs modality: low_dim with keys: ['robot0_eef_pos', 'robot0_eef_quat', 'object', 'robot0_gripper_qpos']
using obs modality: rgb with keys: []
using obs modality: depth with keys: []
using obs modality: scan with keys: []

============= Loaded Environment Metadata =============
obs key object with shape (23,)
obs key robot0_eef_pos with shape (3,)
obs key robot0_eef_quat with shape (4,)
obs key robot0_gripper_qpos with shape (2,)
Created environment with name Lifteither
Action size is 7
Lifteither
{
    "camera_depths": false,
    "controller_configs": {
        "control_delta": true,
        "damping_ratio": 1,
        "damping_ratio_limits": [
            0,
            10
        ],
        "impedance_mode": "fixed",
        "input_max": 1,
        "input_min": -1,
        "interpolation": null,
        "kp": 700,
        "kp_limits": [
            0,
            300
        ],
        "orientation_limits": null,
        "output_max": [
            0.05,
            0.05,
            0.05,
            0.5,
            0.5,
            0.5
        ],
        "output_min": [
            -0.05,
            -0.05,
            -0.05,
            -0.5,
            -0.5,
            -0.5
        ],
        "position_limits": null,
        "ramp_ratio": 0.2,
        "type": "OSC_POSE",
        "uncouple_pos_ori": true
    },
    "has_offscreen_renderer": true,
    "has_renderer": false,
    "ignore_done": true,
    "render_gpu_device_id": 0,
    "reward_shaping": false,
    "robots": "Panda",
    "use_camera_obs": false,
    "use_object_obs": true
}

wandb: Currently logged in as: thegrey (p-gaze-for-robots). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.2
wandb: Run data is saved locally in /home/dhanush/shreya_gaze_project/robomimic/robomimic/../hbc_trained_models_128_54_58_209_data_horizon_60_kl_10/128_54_58_209_data_horizon_60_kl_10/20240710163112/logs/wandb/run-20240710_163116-3kfnud6b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 128_54_58_209_data_horizon_60_kl_10
wandb:  View project at https://wandb.ai/p-gaze-for-robots/gaze_for_robots
wandb:  View run at https://wandb.ai/p-gaze-for-robots/gaze_for_robots/runs/3kfnud6b
ObservationKeyToModalityDict: latent not found, adding latent to mapping with assumed low_dim modality!

============= Model Summary =============
ObservationKeyToModalityDict: mean not found, adding mean to mapping with assumed low_dim modality!
ObservationKeyToModalityDict: logvar not found, adding logvar to mapping with assumed low_dim modality!
ObservationKeyToModalityDict: action not found, adding action to mapping with assumed low_dim modality!
HBC(subgoal_horizon=60, actor_horizon=10, subgoal_update_interval=30, mode=separate, actor_use_random_subgoals=False)
Planner:
  GL_VAE (
    ModuleDict(
      (goal_network): VAE(
        (nets): ModuleDict(
          (encoder): MIMO_MLP(
              encoder=ObservationGroupEncoder(
                  group=input
                  ObservationEncoder(
                      Key(
                          name=object
                          shape=[23]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_eef_pos
                          shape=[3]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_eef_quat
                          shape=[4]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_gripper_qpos
                          shape=[2]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      output_shape=[32]
                  )
                  group=condition
                  ObservationEncoder(
                      Key(
                          name=object
                          shape=[23]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_eef_pos
                          shape=[3]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_eef_quat
                          shape=[4]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_gripper_qpos
                          shape=[2]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      output_shape=[32]
                  )
              )
      
              mlp=MLP(
                  input_dim=64
                  output_dim=400
                  layer_dims=[300]
                  layer_func=Linear
                  dropout=None
                  act=ReLU
                  output_act=ReLU
              )
      
              decoder=ObservationDecoder(
                  Key(
                      name=mean
                      shape=(16,)
                      modality=low_dim
                      net=(Linear(in_features=400, out_features=16, bias=True))
                  )
                  Key(
                      name=logvar
                      shape=(16,)
                      modality=low_dim
                      net=(Linear(in_features=400, out_features=16, bias=True))
                  )
              )
          )
          (decoder): MIMO_MLP(
              encoder=ObservationGroupEncoder(
                  group=input
                  ObservationEncoder(
                      Key(
                          name=latent
                          shape=(16,)
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      output_shape=[16]
                  )
                  group=condition
                  ObservationEncoder(
                      Key(
                          name=object
                          shape=[23]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_eef_pos
                          shape=[3]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_eef_quat
                          shape=[4]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      Key(
                          name=robot0_gripper_qpos
                          shape=[2]
                          modality=low_dim
                          randomizer=None
                          net=None
                          sharing_from=None
                      )
                      output_shape=[32]
                  )
              )
      
              mlp=MLP(
                  input_dim=48
                  output_dim=400
                  layer_dims=[300]
                  layer_func=Linear
                  dropout=None
                  act=ReLU
                  output_act=ReLU
              )
      
              decoder=ObservationDecoder(
                  Key(
                      name=object
                      shape=[23]
                      modality=low_dim
                      net=(Linear(in_features=400, out_features=23, bias=True))
                  )
                  Key(
                      name=robot0_eef_pos
                      shape=[3]
                      modality=low_dim
                      net=(Linear(in_features=400, out_features=3, bias=True))
                  )
                  Key(
                      name=robot0_eef_quat
                      shape=[4]
                      modality=low_dim
                      net=(Linear(in_features=400, out_features=4, bias=True))
                  )
                  Key(
                      name=robot0_gripper_qpos
                      shape=[2]
                      modality=low_dim
                      net=(Linear(in_features=400, out_features=2, bias=True))
                  )
              )
          )
          (prior): GaussianPrior(
              latent_dim=16
              latent_clip=None
              learnable=False
              input_dependent=False
              use_gmm=False
          )
        )
      )
    )
  )

Policy:
  BC_RNN (
    ModuleDict(
      (policy): RNNActorNetwork(
          action_dim=7
  
          encoder=ObservationGroupEncoder(
              group=obs
              ObservationEncoder(
                  Key(
                      name=object
                      shape=[23]
                      modality=low_dim
                      randomizer=None
                      net=None
                      sharing_from=None
                  )
                  Key(
                      name=robot0_eef_pos
                      shape=[3]
                      modality=low_dim
                      randomizer=None
                      net=None
                      sharing_from=None
                  )
                  Key(
                      name=robot0_eef_quat
                      shape=[4]
                      modality=low_dim
                      randomizer=None
                      net=None
                      sharing_from=None
                  )
                  Key(
                      name=robot0_gripper_qpos
                      shape=[2]
                      modality=low_dim
                      randomizer=None
                      net=None
                      sharing_from=None
                  )
                  output_shape=[32]
              )
          )
  
          rnn=RNN_Base(
            (per_step_net): Sequential(
              (0): MLP(
                  input_dim=400
                  output_dim=1024
                  layer_dims=[1024]
                  layer_func=Linear
                  dropout=None
                  act=ReLU
                  output_act=ReLU
              )
              (1): ObservationDecoder(
                  Key(
                      name=action
                      shape=(7,)
                      modality=low_dim
                      net=(Linear(in_features=1024, out_features=7, bias=True))
                  )
              )
            )
            (nets): LSTM(32, 400, num_layers=2, batch_first=True)
          )
      )
    )
  )

SequenceDataset: loading dataset into memory...
  0%|          | 0/128 [00:00<?, ?it/s] 25%|##5       | 32/128 [00:00<00:00, 313.58it/s] 50%|#####     | 64/128 [00:00<00:00, 310.54it/s] 75%|#######5  | 96/128 [00:00<00:00, 306.01it/s]100%|##########| 128/128 [00:00<00:00, 308.39it/s]100%|##########| 128/128 [00:00<00:00, 308.47it/s]
SequenceDataset: caching get_item calls...
  0%|          | 0/36746 [00:00<?, ?it/s]  4%|4         | 1593/36746 [00:00<00:02, 15928.34it/s]  9%|8         | 3186/36746 [00:00<00:02, 15797.66it/s] 13%|#2        | 4766/36746 [00:00<00:02, 15607.26it/s] 17%|#7        | 6355/36746 [00:00<00:01, 15714.85it/s] 22%|##1       | 7927/36746 [00:00<00:01, 15639.92it/s] 26%|##5       | 9523/36746 [00:00<00:01, 15746.34it/s] 30%|###       | 11098/36746 [00:00<00:02, 12498.60it/s] 35%|###4      | 12681/36746 [00:00<00:01, 13395.08it/s] 39%|###8      | 14266/36746 [00:00<00:01, 14076.33it/s] 43%|####3     | 15863/36746 [00:01<00:01, 14613.31it/s] 47%|####7     | 17407/36746 [00:01<00:01, 14850.00it/s] 52%|#####1    | 19017/36746 [00:01<00:01, 15213.62it/s] 56%|#####6    | 20662/36746 [00:01<00:01, 15577.02it/s] 61%|######    | 22245/36746 [00:01<00:00, 15649.89it/s] 65%|######4   | 23826/36746 [00:01<00:00, 15696.32it/s] 69%|######9   | 25445/36746 [00:01<00:00, 15841.61it/s] 74%|#######3  | 27057/36746 [00:01<00:00, 15922.38it/s] 78%|#######8  | 28689/36746 [00:01<00:00, 16040.07it/s] 82%|########2 | 30297/36746 [00:01<00:00, 15990.14it/s] 87%|########6 | 31899/36746 [00:02<00:00, 15982.75it/s] 91%|#########1| 33499/36746 [00:02<00:00, 15938.00it/s] 96%|#########5| 35095/36746 [00:02<00:00, 15905.55it/s]100%|#########9| 36718/36746 [00:02<00:00, 16000.28it/s]100%|##########| 36746/36746 [00:02<00:00, 15360.23it/s]
> [0;32m/home/dhanush/shreya_gaze_project/robomimic/robomimic/utils/dataset.py[0m(613)[0;36mget_dataset_sampler[0;34m()[0m
[0;32m    612 [0;31m        [0mipdb[0m[0;34m.[0m[0mset_trace[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m--> 613 [0;31m        [0;32mreturn[0m [0mCustomSampler[0m[0;34m([0m[0mstart_locations[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_demo_id_to_start_indices[0m[0;34m,[0m [0mtotal_length[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mtotal_num_sequences[0m[0;34m,[0m [0mindividual_length[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_demo_id_to_demo_length[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    614 [0;31m        [0;32mreturn[0m [0;32mNone[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb> > [0;32m/home/dhanush/shreya_gaze_project/robomimic/robomimic/utils/dataset.py[0m(641)[0;36mcalculate_probabilities[0;34m()[0m
[0;32m    640 [0;31m            [0;31m# Gaussian-like distribution centered around start locations[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m--> 641 [0;31m            [0;32mfor[0m [0mkey[0m [0;32min[0m [0mself[0m[0;34m.[0m[0mstart_locations[0m[0;34m.[0m[0mkeys[0m[0;34m([0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    642 [0;31m                [0mstart_loc[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mstart_locations[0m[0;34m[[0m[0mkey[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb> > [0;32m/home/dhanush/shreya_gaze_project/robomimic/robomimic/utils/dataset.py[0m(653)[0;36mcalculate_probabilities[0;34m()[0m
[0;32m    652 [0;31m            [0;31m# Normalize probabilities[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m--> 653 [0;31m            [0mprobabilities[0m [0;34m=[0m [0mprobabilities[0m [0;34m/[0m [0mprobabilities[0m[0;34m.[0m[0msum[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    654 [0;31m[0;34m[0m[0m
[0m
ipdb> 
============= Training Dataset =============
SequenceDataset (
	path=/home/dhanush/shreya_gaze_project/robosuite_vd/robosuite/models/assets/demonstrations/new_data_diverse_128_demos/low_dim.hdf5
	obs_keys=('object', 'robot0_eef_pos', 'robot0_eef_quat', 'robot0_gripper_qpos')
	seq_length=75
	filter_key=none
	frame_stack=1
	pad_seq_length=True
	pad_frame_stack=True
	goal_mode=none
	cache_mode=all
	num_demos=128
	num_sequences=36746
)

**************************************************
Warnings generated by robomimic have been duplicated here (from above) for convenience. Please check them carefully.
**************************************************

  0%|          | 0/100 [00:00<?, ?it/s]> [0;32m/home/dhanush/shreya_gaze_project/robomimic/robomimic/utils/train_utils.py[0m(570)[0;36mrun_epoch[0;34m()[0m
[0;32m    569 [0;31m        [0mipdb[0m[0;34m.[0m[0mset_trace[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m--> 570 [0;31m        [0mstep_log[0m [0;34m=[0m [0mmodel[0m[0;34m.[0m[0mlog_info[0m[0;34m([0m[0minfo[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    571 [0;31m        [0mstep_log_all[0m[0;34m.[0m[0mappend[0m[0;34m([0m[0mstep_log[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb> 